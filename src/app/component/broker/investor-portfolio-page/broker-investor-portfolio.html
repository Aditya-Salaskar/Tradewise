
<header>
  <h2>Investor Portfolio</h2>
  <p class="subtle">Read-only view of an investor’s holdings and valuation for advisory.</p>
</header>

<!-- Investor Switcher (minimal, same page navigation) -->
<section class="add-section">
  <h3>Load Another Investor</h3>
  <form (ngSubmit)="loadInvestor()" #switchForm="ngForm">
    <div class="switch-grid">
      <div class="form-field">
        <label for="investorId">Investor ID</label>
        <input id="investorId" name="investorId" type="text" [(ngModel)]="investorIdInput" required placeholder="e.g., INV-1001" />
      </div>
      <div class="form-actions">
        <button class="primary" type="submit" [disabled]="!switchForm.form.valid || loading">Load Portfolio</button>
        <button class="secondary" type="button" (click)="goBack()">Back</button>
      </div>
    </div>
  </form>
</section>

<!-- Investor Summary -->
<section class="stats" *ngIf="summary">
  <div class="card">
    <h3>Investor</h3>
    <p>{{ summary.name }} <span class="muted">({{ summary.id }})</span></p>
  </div>
  <div class="card">
    <h3>Total Value</h3>
    <p>{{ summary.totalValue | number:'1.2-2' }}</p>
  </div>
  <div class="card">
    <h3>Total Cost</h3>
    <p>{{ summary.totalCost | number:'1.2-2' }}</p>
  </div>
  <div class="card">
    <h3>Unrealized P/L</h3>
    <p [class.profit]="summary.unrealizedPL >= 0" [class.loss]="summary.unrealizedPL < 0">
      {{ summary.unrealizedPL | number:'1.2-2' }}
    </p>
  </div>
  <div class="card">
    <h3>Holdings</h3>
    <p>{{ summary.holdingsCount }}</p>
  </div>
  <div class="card">
    <h3>Risk Profile</h3>
    <p>{{ summary.riskProfile }}</p>
  </div>
</section>

<!-- Holdings Table -->
<section class="table-section">
  <h3>Holdings</h3>
  <div class="filters">
    <input type="text" placeholder="Search by symbol/name…" [(ngModel)]="searchTerm" />
    <button class="secondary" (click)="refresh()" [disabled]="loading">Refresh</button>
  </div>

  <div class="table-container">
    <table>
      <thead>
        <tr>
          <th>Symbol</th>
          <th>Name</th>
          <th>Qty</th>
          <th>Avg Cost</th>
          <th>LTP</th>
          <th>Market Value</th>
          <th>Unrealized P/L</th>
          <th>P/L %</th>
          <th>Allocation %</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let h of filteredHoldings()">
          <td>{{ h.symbol }}</td>
          <td>{{ h.name }}</td>
          <td>{{ h.quantity | number }}</td>
          <td>{{ h.avgCost | number:'1.2-2' }}</td>
          <td>{{ h.ltp | number:'1.2-2' }}</td>
          <td>{{ h.marketValue | number:'1.2-2' }}</td>
          <td [class.profit]="h.unrealizedPL >= 0" [class.loss]="h.unrealizedPL < 0">
            {{ h.unrealizedPL | number:'1.2-2' }}
          </td>
          <td [class.profit]="h.plPercent >= 0" [class.loss]="h.plPercent < 0">
            {{ h.plPercent | number:'1.2-2' }}%
          </td>
          <td>{{ h.allocationPercent | number:'1.2-2' }}%</td>
          <td>
            <button class="primary" (click)="viewInstrument(h.symbol)">View Instrument</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Loading -->
  <div class="loading" *ngIf="loading">Loading portfolio...</div>
</section>
